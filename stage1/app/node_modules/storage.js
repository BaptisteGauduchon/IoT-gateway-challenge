var loki = require('lokijs');

// db options
var lokijsOptions = 
	{
		//autosave: true,
		//autosaveInterval: 5*1000,
		//autoload: true,
		//autoloadCallback: loadHandler,
		//adapter: 'fs'
	}

// init db
var db = new loki('lokidb.json', lokijsOptions);

// load persisted database if any
/*function loadHandler() {

	// load database
	//db.loadDatabase();

	// initialize database if not already existing
    if(!db.getCollection('messages')) {
 	   db.addCollection('messages', {unique: ['id']})
	}
}*/

// initialize messages collection if not already existing
if(!db.getCollection('messages')) {
	db.addCollection('messages', {unique: ['id']});
}

// exports collections
module.exports = {
	messages : db.getCollection('messages'),
};