var loki = require('lokijs');

// db options
var lokijsOptions = 
	{
		autosave: true,
		autosaveInterval: 5*1000,
		//autoload: true,
		//autoloadCallback: loadHandler,
		//adapter: 'fs'
	}

// create db connection
var db = new loki('lokidb.json', lokijsOptions);

// load persisted database if any
/*function loadHandler() {

	// load database
	//db.loadDatabase();

	// initialize database if not already existing
    if(!db.getCollection('messages')) {
 	   db.addCollection('messages')
	}
}*/

// initialize database if not already existing
if(!db.getCollection('messages')) {
	db.addCollection('messages', {unique: ['id']});
}

/*if(!db.getCollection('messageIds')) {
	db.addCollection('messageIds', {unique: ['id']});
}*/


// exports collections
module.exports = {
	messages : db.getCollection('messages'),
	/*messageIds : db.getCollection('messageIds')*/
};