var validator = require('validator');

module.exports = {

	// validate message data
	validate : function(message, callback) {

		// potentials errors
		var errors = [];

		// chack id
		if(!validator.isAlpha(message.id) || !validator.isLength(message.id,{min : 1, max : 64})) {
			errors.push({input : "id", error : "id must be an alpha string with a length in range [1,64]"});
		}

		// check timestamp
		if (!validator.isDate(message.timestamp)) {
			errors.push({input : "timestamp", error : "timestamp must be RFC3339 complient"});
		}

		// check sensor type
		if (!validator.isInt(message.sensorType, {min : 0, max : 2147483647})) {
			errors.push({input : "sensorType", error : "sensorType must be an int32"});
		}

		// check value
		if (!validator.isInt(message.value, {min : 0, max : 9223372036854775807})) {
			errors.push({input : "value", error : "sensorType must be an int64"});
		}
		
		// return errors if any
		if (errors.length > 0) {
			callback(errors);
		} else {
			callback(null);
		}
	},

};